YUI.add("flickr-photos-getLocation-fetcher",function(e){"use strict";function t(t,r){var i=t.photo||{},s=i.location||null,o,u=i.staticMaps&&i.staticMaps.staticMap||null,a=i.venues?i.venues.venue:null,f,l=[];return f={id:i.id,levels:{}},s?(o={id:i.id,hasGeo:!0,latitude:s.latitude,longitude:s.longitude},["neighbourhood","locality","region","county","country"].forEach(function(e){if(!s[e])return;f.levels[e]={name:s[e].content||null,woeId:s[e].woeid||null}})):o={id:i.id,hasGeo:!1},r.exists(o.id)||r.add(o),f.geo=r.proxy(o.id),a&&(f.levels.venue={name:a.content||a.address||null,woeId:a.woe_id,source:a.source,venueId:a.id,venueLat:a.latitude,venueLong:a.longitude},a.content&&l.push(a.content),a.city&&l.push(a.city),a.country&&l.push(a.country),f.text=l.join(", ")),f.text||(f.text=n(f.levels)),e.Lang.isArray(u)&&(f.staticMaps={},u.forEach(function(e){f.staticMaps["zoom"+e.zoom]=e})),f}function n(e){var t=[],n,r,i;n=[["venue","locality","region"],["neighbourhood","locality","region"],["locality","region","country"],["county","region","country"]];while(n.length&&t.length<3){r=n.shift(),t=[];while(r.length&&t.length<3)i=r.shift(),e[i]&&e[i].name&&t.push(e[i].name)}return t.join(", ")}function r(t,n){var r=t.id,i={photo_id:r,extras:"venue"},s=this;return e.APIHelper.request.addStaticMapsParams(i),e.Promise.all([n.callAPI("flickr.photos.geo.getLocation",i),n.getModelRegistry("photo-location-models"),n.getModelRegistry("photo-geo-models")]).then(function(e){var t=e[0],n=e[1],r=e[2],i=s.mapResponse(e[0],r);return n.exists(t.photo.id)||n.add(i),i},function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-getLocation-fetcher] failed getting or processing API response: ",e),e})}e.namespace("ModelFetchers")["flickr-photos-getLocation"]={run:r,mapResponse:t}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-geo-models","photo-location-models"]});
YUI.add("flickr-favorites-add-updater",function(e){"use strict";function t(e,t){var n={};return n.photo_id=e.photoId,t.callAPI("flickr.favorites.add",n).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-favorites-add-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-favorites-add"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-favorites-remove-updater",function(e){"use strict";function t(e,t){var n={};return n.photo_id=e.photoId,t.callAPI("flickr.favorites.remove",n).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-favorites-remove-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-favorites-remove"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("photo-engagement-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i;return e.Lang.isObject(n,!0)&&"isFaved"in n&&(i=n.isFaved.newVal?"flickr-favorites-add":"flickr-favorites-remove",r.push(e.ModelUpdaters[i].run({photoId:t},this.appContext))),e.Promise.all(r)}},toggleFave:function(e){var t=this.getValue(e,"faveCount"),n=this.getValue(e,"isFaved"),r=!n,i=t+(r?1:-1);this.setValues(e,{isFaved:r,faveCount:i})},addAsFave:function(e){var t=this.getValue(e,"faveCount"),n=this.getValue(e,"isFaved");return n?!1:(this.setValues(e,{isFaved:!0,faveCount:t+1}),!0)},attributes:{ownerNsid:{},isFaved:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},faveCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},canShare:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canDownload:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},commentCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},noteCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},viewCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t},defaultValue:0},isOwner:{readOnly:!0,derivedBy:["owner"],getter:function(e,t){var n=this.appContext.getViewer();return!!n.signedIn&&this.getValue(t,"ownerNsid")===n.nsid}},canFave:{readOnly:!0,derivedBy:["is_owner"],getter:function(e,t){return!this.getValue(t,"isOwner")}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","flickr-favorites-add-updater","flickr-favorites-remove-updater","attribute-helpers"]});
YUI.add("flickr-photos-setDates-updater",function(e){"use strict";function t(t,n){var r={};return t.fullResponse?(r.photo_ids=t.photoId,r.full_response=1):r.photo_id=t.photoId,t.datePosted&&(r.date_posted=t.datePosted),t.dateTaken&&(r.date_taken=t.dateTaken),t.takenGranularity>=0&&t.takenGranularity<=10&&(r.date_taken_granularity=t.takenGranularity),e.Promise.all([n.callAPI("flickr.photos.setDates",r),n.getModelRegistry("photo-stats-models")]).then(function(e){var r=e[0],i=e[1],s,o={};s=r.errors;if(t.fullResponse){if(s&&r.errors.length>0)return s}else{if(!i.exists(t.photoId))throw new Error("[flickr-photos-setDates-updater] - Photo-stats model can not be updated if it does not exist");(!r.photo||!r.photo.datePosted&&!r.photo.dateTaken)&&n.warn("[flickr-photos-setDates-updater] - No updated data returned from API."),r.photo?(r.photo.datePosted&&(o.datePosted=r.photo.datePosted.content),r.photo.dateTaken&&(o.dateTaken=r.photo.dateTaken.content,o.takenGranularity=r.photo.dateTakenGranularity.content)):(t.datePosted&&(o.datePosted=t.datePosted),t.dateTaken&&(o.dateTaken=t.dateTaken),t.takenGranularity&&(o.takenGranularity=t.takenGranularity)),Object.keys(o).length>0&&i.setValues(t.photoId,o)}},function(e){throw t.fullResponse?e.photoIds=t.photoId:n[e.fatal?"error":"debug"]("[flickr-photos-setDates-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-photos-setDates"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("photo-stats-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)},update:function(t,n){var r={photoId:t},i=!0;return n.datePosted&&(r.datePosted=n.datePosted.newVal,i=!1),n.dateTaken&&(r.dateTaken=n.dateTaken.newVal,i=!1),n.takenGranularity&&(r.takenGranularity=n.takenGranularity.newVal,i=!1),i?e.Promise.resolve():e.ModelUpdaters["flickr-photos-setDates"].run(r,this.appContext)},batchUpdate:function(t,n){return"postedDate"in n&&"takenDate"in n?e.ModelUpdaters["flickr-photos-setDates"].run({photoId:t,datePosted:n.postedDate,dateTaken:n.takenDate,takenGranularity:n.takenGranularity,fullResponse:1},this.appContext):"postedDate"in n?e.ModelUpdaters["flickr-photos-setDates"].run({photoId:t,datePosted:n.postedDate,fullResponse:1},this.appContext):e.ModelUpdaters["flickr-photos-setDates"].run({photoId:t,dateTaken:n.takenDate,takenGranularity:n.takenGranularity,fullResponse:1},this.appContext)}},attributes:{dateTaken:{},datePosted:{},takenGranularity:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){t=e.AttributeHelpers.coerceInteger(t);if(t<0||t>10)t=undefined;return t},defaultValue:0},isDateTakenUnknown:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return t=e.AttributeHelpers.coerceBoolean(t),t},defaultValue:!1},isCirca:{readOnly:!0,derivedBy:["takenGranularity"],defaultFn:function(e){return this.getValue(e,"takenGranularity")===8}},isSometime:{readOnly:!0,derivedBy:["takenGranularity"],defaultFn:function(e){return this.getValue(e,"takenGranularity")===6}}},getDateObj:function(t,n){if(n!=="dateTaken"&&n!=="datePosted")throw new Error(this.intlMessage({intlName:"models.BAD_DATE_TYPE"}));var r={},i=this.getValue(t,n),s=this.getValue(t,"takenGranularity");return i?(n==="dateTaken"?s===8?r={granularity:s,year:i.replace(/^([\d]+)(.*)/g,"$1"),monthName:this.intlMessage({intlName:"common.CIRCA"})}:s===6?(i=e.moment(i),r={granularity:s,year:i.format("YYYY"),monthName:this.intlMessage({intlName:"common.SOMETIME_IN"})}):s===4?(i=e.moment(i),r={granularity:s,year:i.format("YYYY"),month:i.format("M"),monthName:i.format("MMMM")}):(i=e.moment(i),r={granularity:s,year:i.format("YYYY"),month:i.format("M"),monthName:i.format("MMMM"),day:i.format("D"),hour:i.format("HH"),minute:i.format("mm"),second:i.format("ss")}):(i=e.moment(i,"X"),r={granularity:s,year:i.format("YYYY"),month:i.format("M"),monthName:i.format("MMMM"),day:i.format("D"),hour:i.format("HH"),minute:i.format("mm"),second:i.format("ss")}),r):{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","attribute-helpers","flickr-photos-setDates-updater","moment"],langBundles:["models","common"]});
YUI.add("hermes-lang-models",function(e,t){e.Intl.add("hermes/models","en-US",{YOUR_PHOTOSTREAM:["Your photostream"],USER_PHOTOSTREAM:["${name}","'s photostream"],PHOTOSTREAM:["Photostream"],ZERO_PHOTOS:["0 photos"],ONE_PHOTO:["1 photo"],MULTIPLE_PHOTOS:["${photos}"," photos"],ONE_VIDEO:["1 video"],ONE_PHOTO_AND_ONE_VIDEO:["1 photo and 1 video"],MULTIPLE_PHOTOS_AND_ONE_VIDEO:["${photos}"," photos and 1 video"],MULTIPLE_VIDEOS:["${videos}"," videos"],ONE_PHOTO_AND_MULTIPLE_VIDEOS:["1 photo and ","${videos}"," videos"],MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS:["${photos}"," photos and ","${videos}"," videos"],PHOTO_LIST:["Photo list"],EXPlORE_TITLE:["Explore ","${id}"],BAD_DATE_TYPE:["Bad date type"],ZERO_ITEMS:["0 items"],ONE_ITEM:["1 item"],MULTIPLE_ITEMS:["${items}"," items"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-common",function(e,t){e.Intl.add("hermes/common","en-US",{SIGN_UP:["Sign Up"],YOU:["You"],PHOTOSTREAM:["Photostream"],SETS:["Sets"],ALBUMS:["Albums"],MAP:["Map"],FAVORITES:["Favorites"],GALLERIES:["Galleries"],COLLECTIONS:["Collections"],ARCHIVES:["Archives"],TAGS:["Tags"],PHOTOS_OF:["Photos of"],PROFILE:["Profile"],POPULAR:["Popular"],EXPLORE:["Explore"],ACTIVITY:["Recent activity"],STATS:["Stats"],ORGANIZE:["Organize"],HELP:["Help"],SETTINGS:["Settings"],SIGN_OUT:["Sign Out"],FLICKRMAIL:["FlickrMail"],ERROR:["Error"],OK:["OK"],OOPS:["Oops!"],SIGN_IN:["Sign in"],FORGET_IT:["Forget it"],WARNING:["Warning"],DONE:["Done"],ZOINKS:["Zoinks!"],CANCEL:["Cancel"],ON:["On"],OFF:["Off"],ABOUT:["About"],JOBS:["Jobs"],BLOG:["Blog"],APPS:["Apps"],BRAND:["Brand"],DEVELOPERS:["Developers"],STATUS:["Status"],COMMUNITY_GUIDELINES:["Community guidelines"],REPORT_ABUSE:["Report abuse"],PRIVACY:["Privacy"],TERMS:["Terms"],YAHOO_SAFELY:["Yahoo Safely"],FEEDBACK:["Feedback"],MOBILE:["Mobile"],APP_GARDEN:["App Garden"],COMMUNITY:["Community"],API_DOC:["API Doc"],DEVELOPER_GUIDE:["Developer Guide"],DEVELOPER_BLOG:["Developer Blog"],HELP_FORUM:["Help forum"],GUIDELINES:["Guidelines"],NUMBER:[{type:"number",valueName:"num"}],RETRY:["Retry"],EDIT:["Edit"],MORE:["More"],DELETE:["Delete"],LOADING:["Loading"],FOLLOW:["Follow"],FOLLOWING:["Following"],UNFOLLOW:["Unfollow"],FRIEND:["Friend"],FAMILY:["Family"],A_YAHOO_COMPANY:["Flickr, a Yahoo company"],A_YAHOO_COMPANY_WITH_LINK:['Flickr, <a href="https://info.yahoo.com">a Yahoo company</a>'],CONFIRMATION:["Confirmation"],FAVORITE:["Favorite"],SEARCH:["Search"],CONFIRM:["Confirm"],SELECT:["Select"],NEW:["New"],LOADING_WITH_ELLIPSES:["Loading..."],NONE:["None"],TITLE:["Title"],DESCRIPTION:["Description"],DECLINE:["Decline"],ACCEPT:["Accept"],CIRCA:["Circa"],SOMETIME_IN:["Sometime in..."],JANUARY:["January"],FEBRUARY:["February"],MARCH:["March"],APRIL:["April"],MAY:["May"],JUNE:["June"],JULY:["July"],AUGUST:["August"],SEPTEMBER:["September"],OCTOBER:["October"],NOVEMBER:["November"],DECEMBER:["December"],SAVE:["Save"],PLEASE_TRY_AGAIN:["Please try again"],YES:["Yes"],SQUARE:["Square"],THUMBNAIL:["Thumbnail"],SMALL:["Small"],MEDIUM:["Medium"],LARGE:["Large"],ORIGINAL:["Original"],REPLACE:["Replace"],SAVING:["Saving"],REPLACING:["Replacing"],JOIN:["Join"],SELECTED:["selected"],PREVIEW:["Preview"],DATE_TAKEN:["Date Taken"],DATE_POSTED:["Date Posted"],PEOPLE:["People"],BETA:["Beta"],INVALID_DATE:["Invalid Date."],INVALID_DATE_TAKEN:["Invalid Date Taken."],INVALID_DATE_POSTED:["Invalid Date Posted."],FUTURE_DATE_POSTED:["Date Posted is set to the future."],INVALID_DATE_VALUE:["One or more of the dates you entered was invalid."],INVALID_DATE_TAKEN_VALUE:["Date Taken value is invalid."],INVALID_DATE_POSTED_VALUE:["Date Posted value is invalid."],DOWNLOAD:["Download"],CHOOSE_VALID_DATE:["Please choose a valid date."],FUTURE_DATE_TAKEN:["Date Taken is set to the future."]})},"@VERSION@",{requires:["intl"]});
YUI.add("flickr-photos-getHtmlMeta-fetcher",function(e){"use strict";function t(e,t){var n=e[0],r=e[1],i;n&&n.HTMLMETA&&(i={id:n.photoId,"og:title":n.HTMLMETA["og:title"],"og:description":n.HTMLMETA["og:description"],"og:type":n.HTMLMETA["og:type"],"og:url":n.HTMLMETA["og:url"],"og:site_name":n.HTMLMETA["og:site_name"],"og:image":n.HTMLMETA["og:image"],"og:image:width":n.HTMLMETA["og:image:width"],"og:image:height":n.HTMLMETA["og:image:height"],"flickr_photos:by":n.HTMLMETA["flickr_photos:by"],"flickr_photos:camera":n.HTMLMETA["flickr_photos:camera"],"flickr_photos:sets":n.HTMLMETA["flickr_photos:sets"],"flickr_photos:groups":n.HTMLMETA["flickr_photos:groups"],"flickr_photos:galleries":n.HTMLMETA["flickr_photos:galleries"],"twitter:card":n.HTMLMETA["twitter:card"],"twitter:site":n.HTMLMETA["twitter:site"],"twitter:app:name:iphone":n.HTMLMETA["twitter:app:name:iphone"],"twitter:description":n.HTMLMETA["twitter:description"],"twitter:app:url:iphone":n.HTMLMETA["twitter:app:url:iphone"],"twitter:creator":n.HTMLMETA["twitter:creator"]},r.exists(t.id)||r.add(i))}function n(t,n){var r=t.id,i={photo_id:r},s=this;return e.Promise.all([n.callAPI("flickr.photos.getHtmlMeta",i),n.getModelRegistry("photo-head-meta-models")]).then(function(e){return s._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-getHtmlMeta-fetcher] failed getting or processing API response:",e),e})}e.namespace("ModelFetchers")["flickr-photos-getHtmlMeta"]={run:n,_processResponse:t}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-head-meta-models"]});
YUI.add("photo-head-meta-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getHtmlMeta"].run(t,this.appContext)}},getFieldsForDisplay:function(e){var t={},n=["og:title","og:description","og:type","og:url","og:site_name","og:image","og:image:width","og:image:height","flickr_photos:by","flickr_photos:camera","flickr_photos:sets","flickr_photos:groups","flickr_photos:galleries","twitter:card","twitter:site","twitter:app:name:iphone","twitter:description","twitter:app:url:iphone","twitter:creator","pinterest"],r=this;return n.forEach(function(n){var i=r.getValue(e,n);typeof i!="undefined"&&(t[n]=i)}),t},attributes:{"og:title":{setter:function(e){return e&&e.replace?e.replace(/"/g,"&quot;"):e}},"og:description":{setter:function(e){return e&&e.replace?e.replace(/"/g,"&quot;"):e}},"og:type":{},"og:url":{},"og:site_name":{},"og:image":{},"og:image:width":{},"og:image:height":{},"flickr_photos:by":{},"flickr_photos:camera":{},"flickr_photos:sets":{},"flickr_photos:groups":{},"flickr_photos:galleries":{},"twitter:card":{},"twitter:site":{},"twitter:app:name:iphone":{},"twitter:description":{setter:function(e){return e&&e.replace?e.replace(/"/g,"&quot;"):e}},"twitter:app:url:iphone":{},"twitter:creator":{},pinterest:{setter:function(e){return e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getHtmlMeta-fetcher","flickr-photos-getInfo-fetcher","attribute-helpers"]});
YUI.add("photo-notes-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},attributes:{notes:{isListProxy:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getInfo-fetcher"]});
YUI.add("flickr-photos-addNotes-creator",function(e){"use strict";function t(e){e.tags=e.tags||[];var t={};return t.photo_id=e.photoId,t.note_x=e.left,t.note_y=e.top,t.note_w=e.width,t.note_h=e.height,t.note_text=e.text,t}function n(e,t){var n=e[0],r=e[1],i=e[2],s=[];return i.exists(n.note.id)||i.add({id:n.note.id,left:t.noteLeft,top:t.noteTop,width:t.noteWidth,height:t.noteHeight,text:t.noteText}),s.push(i.proxy(n.note.id)),r.exists(t.photoId)?s.forEach(function(e){r.getValue(t.photoId,"notes").appendToList(e)}):r.add({id:t.photoId,notes:s}),s}function r(t,n){var r=this;return e.Promise.all([n.callAPI("flickr.photos.notes.add",this._processParams(t)),n.getModelRegistry("photo-notes-models"),n.getModelRegistry("note-models")]).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-addNotes-creator] failed getting or processing API response:",e),e})}e.namespace("ModelCreators")["flickr-photos-addNotes"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise"],optional:["photo-notes-models","note-models"]});
YUI.add("flickr-photos-editNote-updater",function(e){"use strict";function t(e){var t={};return t.note_id=e.noteId,t.note_x=e.noteX,t.note_y=e.noteY,t.note_w=e.noteW,t.note_h=e.noteH,t.note_text=e.noteText,t}function n(e,t){return t.callAPI("flickr.photos.notes.edit",this._processParams(e)).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-photos-editNote-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-photos-editNote"]={run:n,_processParams:t}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photos-deleteNote-deletor",function(e){"use strict";function t(e,t){var n={};return n.note_id=e,t.callAPI("flickr.photos.notes.delete",n).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-photos-deleteNote-deletor] failed getting or processing API response:",e),e})}e.namespace("ModelDeletors")["flickr-photos-deleteNote"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("note-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{create:function(t){return e.ModelCreators["flickr-photos-addNotes"].run(t,this.appContext)},update:function(t,n){var r;return r={noteId:t,noteX:this.getValue(t,"left"),noteY:this.getValue(t,"top"),noteW:this.getValue(t,"width"),noteH:this.getValue(t,"height"),noteText:this.getValue(t,"text")},e.ModelUpdaters["flickr-photos-editNote"].run(r,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-photos-deleteNote"].run(t,this.appContext)}},attributes:{authorName:{setter:function(e){return e}},author:{setter:function(e){return e}},left:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},top:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},width:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},height:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},text:{setter:function(e){return e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-addNotes-creator","flickr-photos-editNote-updater","flickr-photos-deleteNote-deletor","attribute-helpers"]});
YUI.add("autotag-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{"delete":function(t){return e.ModelDeletors["flickr-photos-removeAutotag"].run(t,this.appContext)}},attributes:{autotagValue:{}}})},"@VERSION@",{requires:["flickr-model-registry"]});
YUI.add("flickr-photos-removeAutotag-deletor",function(e){"use strict";function t(e,t){var n={};return n.tag_id=e,t.callAPI("flickr.photos.removeAutotag",n).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-photos-removeAutotag-deletor] failed getting or processing API response:",e),e})}e.namespace("ModelDeletors")["flickr-photos-removeAutotag"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("photo-autotags-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-photos-removeAutotag"].run(t,this.appContext)}},attributes:{autotags:{isListProxy:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-photos-getInfo-fetcher","flickr-photos-removeAutotag-deletor"]});
YUI.add("flickr-photos-getInfo-fetcher",function(e){"use strict";function t(t){var n,r;return n=["sizes","icon_urls","ignored","rev_ignored","tags","autotags","venue","datecreate","is_marketplace_printable","o_dims"].join(","),n=n+","+e.APIHelper.request.getRebootPhotoExtras(),r={datecreate:1,extras:n,photo_id:t.id,get_contexts:1,primary_photo_extras:"url_sq, url_t, url_s, url_m"},t.userId?r.user_id=t.userId:t.pathAlias&&(r.path_alias=t.pathAlias),t.context&&(r.context=t.context,r.num_prev=1,r.num_next=1),t.scrappy&&(e.APIHelper.request.addStaticMapsParams(r),delete r.get_contexts,delete r.primary_photo_extras,delete r.context),r}function n(t,n,i){var s=t.apiResponse,o=t.photoRegistry,u=t.personRegistry,a=t.personRelationshipRegistry,f=t.photoEngagementRegistry,l=t.photoStatsRegistry,c=t.photoPrivacyRegistry,h=t.photoTagsRegistry,p=t.tagRegistry,d=t.photoAutotagsRegistry,v=t.autotagRegistry,m=t.photoNotesRegistry,g=t.noteRegistry,y=t.photoGeoRegistry,b=t.photoLocationRegistry,w=t.photoHeadMetaRegistry,E=t.groupRegistry,S,x={},T,N,C,k,L,A,O=[],M=[],_=[],D,P,H;T={id:s.photo.id,title:s.photo.title.content,description:s.photo.description.content,sizes:e.APIHelper.response.parsePhotoSize(s.photo.sizes.size,!0),needsInterstitial:s.photo.needsInterstitial,canComment:s.photo.editability.cancomment,canAddMeta:s.photo.editability.canaddmeta,safetyLevel:s.photo.safetyLevel,license:s.photo.license,mediaType:s.photo.media,secret:s.photo.secret,isHD:e.APIHelper.response.isHD(s.photo.sizes.size),rotation:s.photo.rotation,hasInvalidColorspaceForPrint:s.photo.hasInvalidColorspaceForPrint,isMarketplacePrintable:s.photo.isMarketplacePrintable,oWidth:s.photo.oWidth?parseInt(s.photo.oWidth,10):"",oHeight:s.photo.oHeight?parseInt(s.photo.oHeight,10):""},N={id:s.photo.owner.nsid,username:s.photo.owner.username,realname:s.photo.owner.realname,pathAlias:s.photo.owner.pathAlias,buddyicon:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(s.photo.owner.iconurls),isAdFree:s.photo.owner.isAdFree,isPro:s.photo.owner.ispro},C={id:s.photo.owner.nsid,pathAlias:s.photo.owner.pathAlias,isContact:s.photo.contactIscontact,isFamily:s.photo.contactIsfamily,isFriend:s.photo.contactIsfriend,isIgnored:s.photo.owner.isignored,isIgnoredBy:s.photo.owner.revIgnored},k={id:s.photo.id,ownerNsid:s.photo.owner.nsid,isFaved:s.photo.isfavorite||!1,canShare:s.photo.usage.canshare,canDownload:s.photo.usage.candownload,commentCount:s.photo.comments.content,noteCount:s.photo.notes&&s.photo.notes.note&&s.photo.notes.note.length,faveCount:s.photo.countFaves,viewCount:s.photo.views},L={id:s.photo.id,dateTaken:s.photo.dates.taken,datePosted:s.photo.dates.posted,takenGranularity:s.photo.dates.takengranularity,isDateTakenUnknown:s.photo.datetakenunknown||s.photo.datetakenunknown==="1"||s.photo.datetakenunknown===1},D={id:s.photo.id,"og:title":s.photo.HTMLMETA["og:title"],"og:description":s.photo.HTMLMETA["og:description"],"og:type":s.photo.HTMLMETA["og:type"],"og:url":s.photo.HTMLMETA["og:url"],"og:site_name":s.photo.HTMLMETA["og:site_name"],"og:image":s.photo.HTMLMETA["og:image"],"og:image:width":s.photo.HTMLMETA["og:image:width"],"og:image:height":s.photo.HTMLMETA["og:image:height"],"flickr_photos:by":s.photo.HTMLMETA["flickr_photos:by"],"flickr_photos:camera":s.photo.HTMLMETA["flickr_photos:camera"],"flickr_photos:sets":s.photo.HTMLMETA["flickr_photos:sets"],"flickr_photos:groups":s.photo.HTMLMETA["flickr_photos:groups"],"flickr_photos:galleries":s.photo.HTMLMETA["flickr_photos:galleries"],"twitter:card":s.photo.HTMLMETA["twitter:card"],"twitter:site":s.photo.HTMLMETA["twitter:site"],"twitter:app:name:iphone":s.photo.HTMLMETA["twitter:app:name:iphone"],"twitter:description":s.photo.HTMLMETA["twitter:description"],"twitter:app:url:iphone":s.photo.HTMLMETA["twitter:app:url:iphone"],"twitter:creator":s.photo.HTMLMETA["twitter:creator"],pinterest:s.photo.HTMLMETA.pinterest},A={id:s.photo.id,isPublic:s.photo.visibility.ispublic,isVisibleByFriends:s.photo.visibility.isfriend,isVisibleByFamily:s.photo.visibility.isfamily,permAddMeta:s.photo.permissions?s.photo.permissions.permaddmeta:0,permComment:s.photo.permissions?s.photo.permissions.permcomment:0},s.photo&&s.photo.tags&&s.photo.tags.tag&&e.Array(s.photo.tags.tag).forEach(function(e){p.exists(e.id)||p.add({id:e.id,tagRaw:e.raw,tagValue:n.isFlipped("tags-charm")?e.content:e.content.replace(/\s/g,""),tagAuthorNSID:e.author,isMachineTag:e.machineTag}),O.push(p.proxy(e.id))}),s.photo&&s.photo.autotags&&s.photo.autotags.autotag&&e.Array(s.photo.autotags.autotag).forEach(function(e){v.exists(s.photo.id+e.content)||v.add({id:s.photo.id+e.content,autotagValue:e.content}),_.push(v.proxy(s.photo.id+e.content))}),s.photo&&s.photo.notes&&s.photo.notes.note&&e.Array(s.photo.notes.note).forEach(function(e){g.exists(e.id)||g.add({id:e.id,authorName:e.authorname,author:e.author,left:e.x,top:e.y,width:e.w,height:e.h,text:e.content}),M.push(g.proxy(e.id))}),P=e.ModelFetchers["flickr-photos-getLocation"].mapResponse(s,y),T.owner=u.exists(N.id)?u.proxy(N.id):u.add(N),T.engagement=f.exists(k.id)?f.proxy(k.id):f.add(k),a.exists(C.id)||a.add(C),H=o.exists(T.id)?o.proxy(T.id):o.add(T),s.photo.isMarketplacePrintable&&H.setValue("isMarketplacePrintable",!0),l.exists(T.id)||l.add(L),c.exists(T.id)||c.add(A),h.exists(T.id)||h.add({id:T.id,tags:O}),d.exists(T.id)||d.add({id:T.id,autotags:_}),m.exists(T.id)||m.add({id:T.id,notes:M}),w.exists(T.id)||w.add(D),b.exists(T.id)||b.add(P),s.photo.contexts&&(S=t.contextsRegistry,x.faves=t.favoriteRegistry,x.gallery=t.galleryRegistry,x.pool=t.groupsPoolRegistry,x.set=t.setRegistry,x.stream=t.photostreamRegistry,r({photoModel:H,contextRegistries:x,contextsResponse:s.photo.contexts,personRegistry:u,contextsRegistry:S,photoEngagementRegistry:f,photoStatsRegistry:l,groupRegistry:E,apiParams:i}))}function r(t){var n=t.photoModel,r=t.contextRegistries,i=t.contextsResponse,s=t.personRegistry,o=t.contextsRegistry,u=t.photoEngagementRegistry,a=t.photoStatsRegistry,f=t.groupRegistry,l=t.apiParams
,c=[];e.Object.each(r,function(t,r){i[r]&&e.Array.each(i[r],function(r){e.APIHelper.response.addContextToRegistry(r,t,s,f),c.push(t.proxy(r.id)),l.context&&function(){var i,o,f,c,h,p,d,v,m;i=t.getValue(r.id,"photoContextList"),o=i.hasMinBoundary?i.hasMinBoundary():!1,f=i.hasMaxBoundary?i.hasMaxBoundary():!1,c=i.getList(),p=r.nextphotos,d=r.prevphotos,v=p?e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:s,photoModelRegistry:n.registry,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}):[],m=d?e.APIHelper.response.parsePhotos({photos:d.photo,personModelRegistry:s,photoModelRegistry:n.registry,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}):[];if(m.length||v.length)h=e.APIHelper.response.addOrReplaceListByContext({model:n,next:v,prev:m.reverse(),current:c,hasMin:o,hasMax:f,numNext:l.num_next,numPrev:l.num_prev});t.setValue(r.id,"photoContextList",h)}()})}),o.exists(n.id)||(o.add({id:n.id,totalGroups:i.pool?i.pool.length:0,totalSets:i.set?i.set.length:0,totalGalleries:i.gallery?i.gallery.length:0}),o.setValue(n.id,"contexts",c))}function i(t,n){var r=this,i;return n.flipper.isFlipped("enable-scrappy-photo-page")&&(t.scrappy=!0),i=this._processParams(t),(new e.FlickrPromise({apiResponse:n.callAPI("flickr.photos.getInfo",i),photoRegistry:n.getModelRegistry("photo-models"),personRegistry:n.getModelRegistry("person-models"),personRelationshipRegistry:n.getModelRegistry("person-relationship-models"),photoEngagementRegistry:n.getModelRegistry("photo-engagement-models"),photoStatsRegistry:n.getModelRegistry("photo-stats-models"),photoPrivacyRegistry:n.getModelRegistry("photo-privacy-models"),photoTagsRegistry:n.getModelRegistry("photo-tags-models"),tagRegistry:n.getModelRegistry("tag-models"),photoAutotagsRegistry:n.getModelRegistry("photo-autotags-models"),autotagRegistry:n.getModelRegistry("autotag-models"),photoNotesRegistry:n.getModelRegistry("photo-notes-models"),noteRegistry:n.getModelRegistry("note-models"),photoGeoRegistry:n.getModelRegistry("photo-geo-models"),photoLocationRegistry:n.getModelRegistry("photo-location-models"),photoHeadMetaRegistry:n.getModelRegistry("photo-head-meta-models"),groupRegistry:n.getModelRegistry("group-models"),contextsRegistry:n.getModelRegistry("photo-contexts-models"),favoriteRegistry:n.getModelRegistry("favorite-models"),galleryRegistry:n.getModelRegistry("gallery-models"),groupsPoolRegistry:n.getModelRegistry("group-pool-models"),setRegistry:n.getModelRegistry("set-models"),photostreamRegistry:n.getModelRegistry("photostream-models")})).then(function(e){return r._processResponse(e,n.flipper,i)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-photos-getInfo-fetcher] failed getting or processing API response:",e),e})}e.namespace("ModelFetchers")["flickr-photos-getInfo"]={run:i,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper","flickr-photos-getLocation-fetcher"],optional:["photo-models","person-models","person-relationship-models","photo-engagement-models","photo-stats-models","photo-geo-models","photo-location-models","photo-head-meta-models","note-models","photo-notes-models","autotag-models","photo-autotags-models"]});
YUI.add("flickr-photos-setPerms-updater",function(e){"use strict";function t(e,t){return t.callAPI("flickr.photos.setPerms",e).then(function(t){if(e.full_response)return t.photoIdsSent=e.photo_ids,t},function(n){throw e.full_response?n.photoIds=e.photo_ids:t[n.fatal?"error":"debug"]("[flickr-photos-setPerms-updater] failed getting or processing API response:",n),n})}e.namespace("ModelUpdaters")["flickr-photos-setPerms"]={run:t}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photos-setMeta-updater",function(e){"use strict";function t(t,n){var r={};return t.fullResponse?(r.full_response=1,r.photo_ids=t.photoId):r.photo_id=t.photoId,typeof t.title!="undefined"&&(r.title=t.title),typeof t.description!="undefined"&&(r.description=t.description),e.Promise.all([n.callAPI("flickr.photos.setMeta",r),n.getModelRegistry("photo-models")]).then(function(e){var r=e[0],i=e[1];if(t.fullResponse){if("errors"in r)return r.api="setMeta",r}else{if(!i.exists(t.photoId))throw new Error("[flickr-photos-setMeta-updater] - Photo model can not be updated if it does not exist");!r.photo||!r.photo.title||!r.photo.description?n.warn("[flickr-photos-setMeta-updater] - No updated data returned from API."):i.setValues(t.photoId,{title:r.photo.title.content,description:r.photo.description.content})}},function(n){throw t.fullResponse?(n.photoIds=t.photoId,n.returnApi="setMeta"):e.Flog[n.fatal?"error":"debug"]("[flickr-photos-setMeta-updater] failed getting or processing API response:",n),n})}e.namespace("ModelUpdaters")["flickr-photos-setMeta"]={run:t}},"@VERSION@",{requires:["flickr-promise","flog"],optional:[]});
YUI.add("flickr-photos-licenses-setLicense-updater",function(e){"use strict";function t(e,t){var n={};return e.fullResponse?(n.photo_ids=e.photoId,n.full_response=1):n.photo_id=e.photoId,n.license_id=e.license,t.callAPI("flickr.photos.licenses.setLicense",n).then(function(e){if("errors"in e)return e.api="setLicense",e},function(n){throw e.fullResponse?(n.photoIds=e.photoId,n.returnApi="setLicense"):t[n.fatal?"error":"debug"]("[flickr-photos-licenses-setLicense-updater] failed getting or processing API response:",n),n})}e.namespace("ModelUpdaters")["flickr-photos-licenses-setLicense"]={run:t}},"@VERSION@",{requires:["flickr-promise"]});
